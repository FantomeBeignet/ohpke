<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>KEM (hpke.Hpke.Kem.KEM)</title><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">hpke</a> &#x00BB; <a href="../../index.html">Hpke</a> &#x00BB; <a href="../index.html">Kem</a> &#x00BB; KEM</nav><header class="odoc-preamble"><h1>Module type <code><span>Kem.KEM</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-nsecret"><a href="#val-nsecret" class="anchor"></a><code><span><span class="keyword">val</span> nsecret : int</span></code></div><div class="spec-doc"><p>The length in bytes of a KEM shared secret produced by this KEM</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-nenc"><a href="#val-nenc" class="anchor"></a><code><span><span class="keyword">val</span> nenc : int</span></code></div><div class="spec-doc"><p>The length in bytes of an encapsulated key produced by this KEM</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-npk"><a href="#val-npk" class="anchor"></a><code><span><span class="keyword">val</span> npk : int</span></code></div><div class="spec-doc"><p>The length in bytes of an encoded public key for this KEM</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-nsk"><a href="#val-nsk" class="anchor"></a><code><span><span class="keyword">val</span> nsk : int</span></code></div><div class="spec-doc"><p>The length in bytes of an encoded private key for this KEM</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-secret"><a href="#type-secret" class="anchor"></a><code><span><span class="keyword">type</span> secret</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate_keypair"><a href="#val-generate_keypair" class="anchor"></a><code><span><span class="keyword">val</span> generate_keypair : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-secret">secret</a> * <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Randomized algorithm to generate a key pair <code>(skX, pkX)</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-derive_keypair"><a href="#val-derive_keypair" class="anchor"></a><code><span><span class="keyword">val</span> derive_keypair : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-secret">secret</a> * <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>derive_keypair ikm</code> : deterministic algorithm to derive a key pair <code>(skX, pkX)</code> from the byte string <code>ikm</code>, where <code>ikm</code> SHOULD have at least <code>nsk</code> bytes of entropy</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-serialize_public_key"><a href="#val-serialize_public_key" class="anchor"></a><code><span><span class="keyword">val</span> serialize_public_key : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>serialize_public_key pkX</code> Produce a byte string of length <code>npk</code> encoding the public key <code>pkX</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-deserialize_public_key"><a href="#val-deserialize_public_key" class="anchor"></a><code><span><span class="keyword">val</span> deserialize_public_key : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Cstruct</span>.t, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>deserialize_public_key pkXm</code> parses a byte string of length <code>npk</code> to recover a public key. This function can return a DeserializeError error upon <code>pkXm</code> deserialization failure</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-deserialize_public_key_exn"><a href="#val-deserialize_public_key_exn" class="anchor"></a><code><span><span class="keyword">val</span> deserialize_public_key_exn : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Same as <code>deserialize_public_key</code> but raises an exception instead of returning an <code>Error</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encap"><a href="#val-encap" class="anchor"></a><code><span><span class="keyword">val</span> encap : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>encap pkR</code> : randomized algorithm to generate an ephemeral, fixed-length symmetric key (the KEM shared secret) and a fixed-length encapsulation of that key that can be decapsulated by the holder of the private key corresponding to <code>pkR</code>. This function can return an EncapError on encapsulation failure</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encap_exn"><a href="#val-encap_exn" class="anchor"></a><code><span><span class="keyword">val</span> encap_exn : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Same as <code>encap</code> but raises an exception instead of returning an <code>Error</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decap"><a href="#val-decap" class="anchor"></a><code><span><span class="keyword">val</span> decap : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Cstruct</span>.t, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decap enc skR</code> : deterministic algorithm using the private key <code>skR</code> to recover the ephemeral symmetric key (the KEM shared secret) from its encapsulated representation <code>enc</code>. This function can return a DecapError on decapsulation failure</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decap_exn"><a href="#val-decap_exn" class="anchor"></a><code><span><span class="keyword">val</span> decap_exn : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Same as <code>decap</code> but raises an exception instead of returning an <code>Error</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-auth_encap"><a href="#val-auth_encap" class="anchor"></a><code><span><span class="keyword">val</span> auth_encap : 
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>auth_encap pkR skS</code> : same as <code>encap</code>, and the outputs encode an assurance that the KEM shared secret was generated by the holder of the private key <code>skS</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-auth_encap_exn"><a href="#val-auth_encap_exn" class="anchor"></a><code><span><span class="keyword">val</span> auth_encap_exn : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Same as <code>auth_encap</code> but raises an exception instead of returning an <code>Error</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-auth_decap"><a href="#val-auth_decap" class="anchor"></a><code><span><span class="keyword">val</span> auth_decap : 
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">Cstruct</span>.t, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>auth_decap enc skR pkS</code> : same as <code>decap</code>, and the recipient is assured that the KEM shared secret was generated by the holder of the private key <code>skS</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-auth_decap_exn"><a href="#val-auth_decap_exn" class="anchor"></a><code><span><span class="keyword">val</span> auth_decap_exn : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-secret">secret</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p>Same as <code>auth_decap</code> but raises an exception instead of returning an <code>Error</code></p></div></div></div></body></html>